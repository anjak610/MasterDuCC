(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     51856,       1301]
NotebookOptionsPosition[     51452,       1285]
NotebookOutlinePosition[     51794,       1300]
CellTagsIndexPosition[     51751,       1297]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.733023876448824*^9, 
  3.7330238783418245`*^9}},ExpressionUUID->"6004d5fd-b489-4189-8d41-\
17e8c82e8fb4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NewRectification", "[", 
    RowBox[{"F_", ",", "epipole_", ",", "epipolePrime_", ",", "images_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Hp", ",", "HpPrime", ",", "HrPrime", ",", "Hr", ",", "w", ",", 
       "wPrime", ",", "eInf", ",", "ePrimeInf", ",", "Vc", ",", 
       "ePrimeHorizontal", ",", "eHorizontal", ",", "RecPointsC2", ",", 
       "RecPointsC1", " ", ",", "RecGraphicPointsC1", ",", 
       "RecGraphicPointsC2", ",", "G2", ",", "G1", ",", "P", ",", "PPrime", 
       ",", "pc", ",", "pcPrime", ",", " ", 
       RowBox[{"pi", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"pj", "=", 
        RowBox[{"{", "}"}]}], ",", "n", ",", "PP", ",", "PPPrime", ",", 
       "pcpc", ",", "pcpcPrime", ",", "A", ",", "APrime", ",", "B", ",", 
       "BPrime", ",", "ex", ",", "ePrimex", ",", "z", ",", "z1", ",", "z2", 
       ",", "piA", ",", "piB", ",", "piC", ",", "piD", ",", "piSA", ",", 
       "piSB", ",", "Hs", ",", "HsPrime", ",", "pjA", ",", "pjB", ",", "pjC", 
       ",", "pjD", ",", "pjSA", ",", "pjSB", ",", "eL", ",", "eLPrime", ","}],
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<\nBegin Image Rectification------------------------------------\n\
\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Image1 = \>\"", 
          RowBox[{"images", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Im1", " ", "=", " ", 
       RowBox[{"images", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Im2", " ", "=", " ", 
       RowBox[{"images", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<images = \>\"", ",", " ", "Im1", ",", "\"\<, \>\"", ",", " ", 
        "Im2"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Image one width  = \>\"", ",", " ", "piWidth"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Image one heigth = \>\"", ",", " ", "piHeigth"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Image two width  = \>\"", ",", " ", "pjWidth"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Image two heigth = \>\"", ",", " ", "pjHeigth"}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"pi", " ", "=", " ", "PixelValue"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pj", " ", "=", " ", 
         RowBox[{"Image", "[", "Im2", "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", " ", "piWidth"}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", " ", "piHeight"}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"pi", ",", " ", 
                RowBox[{"PixelValue", "[", 
                 RowBox[{"Im1", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Length", "[", "pi", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nn", " ", "=", " ", 
       RowBox[{"piWidth", "*", "piHeigth"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Length pi (n) = \>\"", ",", " ", "n"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<nn = \>\"", ",", " ", "nn"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PPrime", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Begin", " ", "complete", " ", "Image", " ", "in", " ", "pixel", " ", 
        "solution"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pc", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"piWidth", "-", "1"}], ")"}], "/", "2"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"piHeight", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pcPrime", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pjWidth", "-", "1"}], ")"}], "/", "2"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pjHeight", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<pc = \>\"", ",", " ", 
        RowBox[{"N", "[", "pc", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<pcPrime = \>\"", ",", " ", 
        RowBox[{"N", "[", "pcPrime", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pcpc", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "4"}], ")"}], "*", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"piWidth", "-", "1"}], ")"}], "^", "2"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"piWidth", "-", "1"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"piHeight", "-", "1"}], ")"}]}], ",", 
            RowBox[{"2", "+", 
             RowBox[{"(", 
              RowBox[{"piWidth", "-", "1"}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"piWidth", "-", "1"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"piHeight", "-", "1"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"piHeight", "-", "1"}], ")"}], "^", "2"}], ",", 
            RowBox[{"2", "+", 
             RowBox[{"(", 
              RowBox[{"piHeight", "-", "1"}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"piWidth", "-", "1"}], ")"}]}], ",", 
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"piHeight", "-", "1"}], ")"}]}], ",", "4"}], "}"}]}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<pcpc = \>\"", ",", " ", 
        RowBox[{"N", "[", "pcpc", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pcpcPrime", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "4"}], ")"}], "*", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"pjWidth", "-", "1"}], ")"}], "^", "2"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"pjWidth", "-", "1"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"pjHeight", "-", "1"}], ")"}]}], ",", 
            RowBox[{"2", "+", 
             RowBox[{"(", 
              RowBox[{"pjWidth", "-", "1"}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"pjWidth", "-", "1"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"pjHeight", "-", "1"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"pjHeight", "-", "1"}], ")"}], "^", "2"}], ",", 
            RowBox[{"2", "+", 
             RowBox[{"(", 
              RowBox[{"pjHeight", "-", "1"}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"pjWidth", "-", "1"}], ")"}]}], ",", 
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"pjHeight", "-", "1"}], ")"}]}], ",", "4"}], "}"}]}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<pcpcPrime = \>\"", ",", " ", "pcpcPrime"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PP", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"piWidth", "*", "piHeight"}], ")"}], "/", "12"}], ")"}], 
        "*", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"piWidth", "^", "2"}], "-", "1"}], ",", "0", ",", "0"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"piHeight", "^", "2"}], "-", "1"}], ",", "0"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<PP = \>\"", ",", " ", 
        RowBox[{"N", "[", "PP", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PPPrime", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pjWidth", "*", "pjHeight"}], ")"}], "/", "12"}], ")"}], 
        "*", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"pjWidth", "^", "2"}], "-", "1"}], ",", "0", ",", "0"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"pjHeight", "^", "2"}], "-", "1"}], ",", "0"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<PPPrime = \>\"", ",", " ", 
        RowBox[{"N", "[", "PPPrime", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ex", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", 
            RowBox[{"epipole", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", 
           RowBox[{"epipole", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"epipole", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
           RowBox[{"-", 
            RowBox[{"epipole", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"epipole", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"epipole", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], "}"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ePrimex", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", 
            RowBox[{"epipolePrime", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", 
           RowBox[{"epipolePrime", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"epipolePrime", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
           RowBox[{"-", 
            RowBox[{"epipolePrime", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"epipolePrime", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"epipolePrime", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], "}"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"A", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "ex", "]"}], ".", "PP", ".", "ex"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"B", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "F", "]"}], ".", "pcpc", ".", "F"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"APrime", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "ePrimex", "]"}], ".", "PPPrime", ".", 
        "ePrimex"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"BPrime", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "F", "]"}], 
        RowBox[{"pcpcPrime", ".", "F"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<A = \>\"", ",", " ", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{"N", "[", "A", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<B = \>\"", ",", " ", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{"N", "[", "B", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<APrime = \>\"", ",", " ", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{"N", "[", "APrime", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<BPrime = \>\"", ",", " ", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{"N", "[", "BPrime", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<{A[[1,1;;2]],A[[2,1;;2]]}=\>\"", ",", 
        RowBox[{"N", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "}"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<{APrime[[1,1;;2]],APrime[[2,1;;2]]}=\>\"", ",", 
        RowBox[{"N", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"APrime", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
           RowBox[{"APrime", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "}"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"DD", "=", 
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", 
             RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
          RowBox[{"A", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", 
             RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DDPrime", "=", 
       RowBox[{"CholeskyDecomposition", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"APrime", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", 
             RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
          RowBox[{"APrime", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", 
             RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<DD =\>\"", ",", " ", 
        RowBox[{"N", "[", "DD", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<DDPrime =\>\"", ",", " ", 
        RowBox[{"N", "[", "DDPrime", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<{B[[1,1;;2]],B[[2,1;;2]]}=\>\"", ",", 
        RowBox[{"N", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
           RowBox[{"B", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "}"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<{BPrime[[1,1;;2]],BPrime[[2,1;;2]]}=\>\"", ",", 
        RowBox[{"N", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"BPrime", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
           RowBox[{"BPrime", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "}"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"DTBD", "=", 
       RowBox[{"Eigensystem", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Inverse", "[", "DD", "]"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
           RowBox[{"B", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "}"}], ".", 
         RowBox[{"Inverse", "[", "DD", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DTBPrimeD", "=", 
       RowBox[{"Eigensystem", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Inverse", "[", "DDPrime", "]"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"BPrime", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
           RowBox[{"BPrime", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "}"}], ".", 
         RowBox[{"Inverse", "[", "DDPrime", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Eigensystem DTBD = \>\"", ",", 
        RowBox[{"N", "[", "DTBD", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      " ", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Eigensystem DTBPrimeD = \>\"", ",", 
        RowBox[{"N", "[", "DTBPrimeD", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"z1", "=", 
       RowBox[{
        RowBox[{"Inverse", "[", "DD", "]"}], ".", 
        RowBox[{"DTBD", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<z1 first = \>\"", ",", 
        RowBox[{
         RowBox[{"Inverse", "[", "DD", "]"}], ".", 
         RowBox[{"DTBD", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DTBD", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[GreaterEqual]", " ", 
         RowBox[{"DTBD", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"z1", "=", 
          RowBox[{
           RowBox[{"Inverse", "[", "DD", "]"}], ".", 
           RowBox[{"DTBD", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<z1 second = \>\"", ",", " ", "z1"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<z1= \>\"", ",", 
        RowBox[{"N", "[", "z1", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"z2", "=", 
       RowBox[{
        RowBox[{"Inverse", "[", "DDPrime", "]"}], ".", 
        RowBox[{"DTBPrimeD", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<z2 first = \>\"", ",", " ", "z2"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DTBPrimeD", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[GreaterEqual]", " ", 
         RowBox[{"DTBPrimeD", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"z2", "=", 
          RowBox[{
           RowBox[{"Inverse", "[", "DDPrime", "]"}], ".", 
           RowBox[{"DTBPrimeD", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<z2 second = \>\"", ",", " ", "z2"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<z2= \>\"", ",", 
        RowBox[{"N", "[", "z2", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"z", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z1", "/", 
          RowBox[{"Normalize", "[", "z1", "]"}]}], "+", 
         RowBox[{"z2", "/", 
          RowBox[{"Normalize", "[", "z2", "]"}]}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"z", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"z", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<z =\>\"", ",", 
        RowBox[{"N", "[", "z", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"w", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", 
             RowBox[{"epipole", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{"epipole", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"epipole", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
            RowBox[{"-", 
             RowBox[{"epipole", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"epipole", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"epipole", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], "}"}], ".", 
        "z"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wPrime", "=", 
       RowBox[{"F", ".", "z"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<w = \>\"", ",", " ", 
        RowBox[{"N", "[", "w", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<wPrime = \>\"", ",", " ", 
        RowBox[{"N", "[", "wPrime", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wPrime", "=", " ", 
       RowBox[{"wPrime", "/", 
        RowBox[{"wPrime", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<wPrime = \>\"", ",", " ", 
        RowBox[{"N", "[", "wPrime", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"w", "=", " ", 
       RowBox[{"w", "/", 
        RowBox[{"w", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<w = \>\"", ",", " ", 
        RowBox[{"N", "[", "w", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"w", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"w", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", 
           RowBox[{"w", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"wPrime", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"wPrime", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", 
           RowBox[{"wPrime", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"HpPrime", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"wPrime", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"wPrime", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"wPrime", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<HpPrime = \>\"", ",", " ", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{"N", "[", "HpPrime", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Hp", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"w", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"w", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"w", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Hp = \>\"", ",", " ", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{"N", "[", "Hp", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ePrimeInf", "=", 
       RowBox[{"HpPrime", ".", "epipolePrime"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eInf", "=", 
       RowBox[{"Hp", ".", "epipole"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<ePrime inf = \>\"", ",", " ", 
        RowBox[{"N", "[", "ePrimeInf", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<e inf = \>\"", ",", " ", 
        RowBox[{"N", "[", "eInf", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Vc", "=", "0"}], ";", 
      RowBox[{"(*", 
       RowBox[{"Wie", " ", "bekomme", " ", "ich", " ", "Vc", " ", "raus", 
        RowBox[{"??", "?"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Hr", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "2"}], "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"w", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"F", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"w", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"F", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "-", 
            RowBox[{"F", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "1"}], "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"w", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"F", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "2"}], "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"w", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"F", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}], "+", "Vc"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"HrPrime", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"wPrime", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"F", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "-", 
            RowBox[{"F", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"wPrime", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"F", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"wPrime", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"F", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "-", 
            RowBox[{"F", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"wPrime", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"F", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "-", 
            RowBox[{"F", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", "Vc"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<HrPrime = \>\"", ",", " ", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{"N", "[", "HrPrime", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Hr = \>\"", ",", " ", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{"N", "[", "Hr", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ePrimeHorizontal", "=", 
       RowBox[{"HrPrime", ".", "ePrimeInf"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<ePrimeHorizontal = \>\"", ",", 
        RowBox[{"N", "[", " ", "ePrimeHorizontal", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eHorizontal", "=", 
       RowBox[{"Hr", ".", "eInf"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<eHorizontal = \>\"", ",", " ", 
        RowBox[{"N", "[", "eHorizontal", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Shearing", " ", "transformation"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"piA", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"piWidth", "-", "1"}], ")"}], "/", "2"}], ",", "0", ",", 
         "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"piB", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"piWidth", "-", "1"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"piHeight", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"piC", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"piWidth", "-", "1"}], ")"}], "/", "2"}], ",", 
         RowBox[{"piHeight", "-", "1"}], ",", "1"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"piD", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"piHeight", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"piA", " ", "=", " ", 
       RowBox[{"Hr", ".", "Hp", ".", "piA"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"piA", " ", "=", " ", 
       RowBox[{"piA", "/", 
        RowBox[{"piA", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"piB", " ", "=", " ", 
       RowBox[{"Hr", ".", "Hp", ".", "piB"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"piB", " ", "=", " ", 
       RowBox[{"piB", "/", 
        RowBox[{"piB", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"piC", " ", "=", " ", 
       RowBox[{"Hr", ".", "Hp", ".", "piC"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"piC", " ", "=", " ", 
       RowBox[{"piC", "/", 
        RowBox[{"piC", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"piD", " ", "=", " ", 
       RowBox[{"Hr", ".", "Hp", ".", "piD"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"piD", " ", "=", " ", 
       RowBox[{"piD", "/", 
        RowBox[{"piD", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<piA = \>\"", ",", " ", "piA"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<piB = \>\"", ",", " ", "piB"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<piC = \>\"", ",", " ", "piC"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<piD = \>\"", ",", " ", "piD"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"piX", "=", 
       RowBox[{"piB", "-", "piD"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"piY", "=", 
       RowBox[{"piC", "-", "piA"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<piX = \>\"", ",", " ", "piX"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<piY = \>\"", ",", " ", "piY"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"piSA", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"piHeight", "^", "2"}], "*", 
           RowBox[{
            RowBox[{"piX", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"piWidth", "^", "2"}], "*", 
           RowBox[{
            RowBox[{"piY", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"piHeight", "*", "piWidth"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"piX", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"piY", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"piX", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"piY", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"piSB", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"piHeight", "^", "2"}], "*", 
           RowBox[{"piX", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{"piX", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"piWidth", "^", "2"}], "*", 
           RowBox[{"piY", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{"piY", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"piHeight", "*", "piWidth"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"piX", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"piY", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"piX", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"piY", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<piSA = \>\"", ",", " ", 
        RowBox[{"N", "[", "piSA", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<piSB = \>\"", ",", " ", 
        RowBox[{"N", "[", "piSB", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Hs", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"piSA", ",", "piSB", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Hs = \>\"", ",", " ", 
        RowBox[{"MatrixForm", "[", "Hs", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pjA", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pjWidth", "-", "1"}], ")"}], "/", "2"}], ",", "0", ",", 
         "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pjB", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pjWidth", "-", "1"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pjHeight", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pjC", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pjWidth", "-", "1"}], ")"}], "/", "2"}], ",", 
         RowBox[{"pjHeight", "-", "1"}], ",", "1"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pjD", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pjHeight", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pjA", "=", " ", 
       RowBox[{"HrPrime", ".", "HpPrime", ".", "pjA"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pjA", " ", "=", " ", 
       RowBox[{"pjA", "/", 
        RowBox[{"pjA", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pjB", "=", " ", 
       RowBox[{"HrPrime", ".", "HpPrime", ".", "pjB"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pjB", " ", "=", " ", 
       RowBox[{"pjB", "/", 
        RowBox[{"pjB", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pjC", "=", " ", 
       RowBox[{"HrPrime", ".", "HpPrime", ".", "pjC"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pjC", " ", "=", " ", 
       RowBox[{"pjC", "/", 
        RowBox[{"pjC", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pjD", "=", " ", 
       RowBox[{"HrPrime", ".", "HpPrime", ".", "pjD"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pjD", " ", "=", " ", 
       RowBox[{"pjD", "/", 
        RowBox[{"pjD", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<pjA = \>\"", ",", " ", 
        RowBox[{"N", "[", "pjA", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<pjB = \>\"", ",", " ", 
        RowBox[{"N", "[", "pjB", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<pjC = \>\"", ",", " ", 
        RowBox[{"N", "[", "pjC", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<pjD = \>\"", ",", " ", 
        RowBox[{"N", "[", "pjD", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pjX", "=", 
       RowBox[{"pjB", "-", "pjD"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pjY", "=", 
       RowBox[{"pjC", "-", "pjA"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<pjX = \>\"", ",", " ", 
        RowBox[{"N", "[", "pjX", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<pjY = \>\"", ",", " ", 
        RowBox[{"N", "[", "pjY", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pjSA", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"pjHeight", "^", "2"}], "*", 
           RowBox[{
            RowBox[{"pjX", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"pjWidth", "^", "2"}], "*", 
           RowBox[{
            RowBox[{"pjY", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pjHeight", "*", "pjWidth"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"pjX", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"pjY", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"pjX", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"pjY", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pjSB", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"pjHeight", "^", "2"}], "*", 
           RowBox[{"pjX", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{"pjX", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"pjWidth", "^", "2"}], "*", 
           RowBox[{"pjY", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{"pjY", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pjHeight", "*", "pjWidth"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"pjX", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"pjY", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"pjX", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"pjY", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<pjSA = \>\"", ",", " ", 
        RowBox[{"N", "[", "pjSA", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<pjSB = \>\"", ",", " ", 
        RowBox[{"N", "[", "pjSB", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"HsPrime", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"pjSA", ",", "pjSB", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<HsPrime = \>\"", ",", " ", 
        RowBox[{"MatrixForm", "[", "HsPrime", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Im1new", "=", "Im1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"H1", " ", "=", " ", 
       RowBox[{"Hr", ".", "Hp"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Im1new", " ", "=", " ", 
       RowBox[{"ImagePerspectiveTransformation", "[", 
        RowBox[{"Im1", ",", "Hp"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Im1new", ",", "\"\<,\>\"", ",", "Im1"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Im2new", "=", "Im2"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Im2new", " ", "=", " ", 
       RowBox[{"ImagePerspectiveTransformation", "[", 
        RowBox[{"Im2", ",", "HpPrime"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Im2new[[10]] = \>\"", ",", 
        RowBox[{"PixelValue", "[", 
         RowBox[{"Im2new", ",", 
          RowBox[{"{", 
           RowBox[{"50", ",", "50"}], "}"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Im2new", " ", "=", " ", 
       RowBox[{"ImagePerspectiveTransformation", "[", 
        RowBox[{"Im2new", " ", ",", "HrPrime"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Im2new", ",", "\"\<,\>\"", ",", "Im2"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", 
       "\"\<\nEnd Image Rectification------------------------------------\n\>\
\"", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.733025565948818*^9, 3.733025608854822*^9}, {
   3.7330256521827993`*^9, 3.733025666132803*^9}, {3.73302573393581*^9, 
   3.733025757525844*^9}, {3.7330277750864515`*^9, 3.7330277753494625`*^9}, {
   3.7330278713734455`*^9, 3.7330279951574917`*^9}, {3.73302817017551*^9, 
   3.733028200461526*^9}, {3.733028235565529*^9, 3.733028238295496*^9}, {
   3.733028268669504*^9, 3.7330283163495374`*^9}, {3.7330283872715187`*^9, 
   3.733028411141554*^9}, {3.73302845283853*^9, 3.7330284530415597`*^9}, {
   3.7330285416845384`*^9, 3.7330285512645693`*^9}, {3.7330286236085806`*^9, 
   3.7330286699944754`*^9}, {3.733028748476615*^9, 3.7330288773366632`*^9}, {
   3.733028917370275*^9, 3.733028932001276*^9}, {3.7330289687292814`*^9, 
   3.7330289853672843`*^9}, {3.7330296348974223`*^9, 3.733029657991395*^9}, {
   3.7330302679293737`*^9, 3.733030276849379*^9}, {3.733030477436324*^9, 
   3.7330305716173677`*^9}, {3.733030641808383*^9, 3.7330306935363555`*^9}, {
   3.733030738587389*^9, 3.7330307388163843`*^9}, {3.7330308399382467`*^9, 
   3.733030868905249*^9}, {3.7330310456182795`*^9, 3.733031114176285*^9}, {
   3.7330311572642965`*^9, 3.7330311879453*^9}, {3.733031257578274*^9, 
   3.7330312601762753`*^9}, {3.733031292355322*^9, 3.7330312934602804`*^9}, {
   3.7330317975228314`*^9, 3.733031852407869*^9}, {3.7330319281240163`*^9, 
   3.733031930916015*^9}, 3.7330319619729877`*^9, {3.733031999027025*^9, 
   3.733031999856017*^9}, 3.7330322632730293`*^9, {3.7330322976370363`*^9, 
   3.733032298531062*^9}, {3.7330324336060543`*^9, 3.733032449598056*^9}, {
   3.733032735380126*^9, 3.733032806375107*^9}, {3.733032856670142*^9, 
   3.7330329434631553`*^9}, {3.733032973968151*^9, 3.733032998591133*^9}, {
   3.7330330511111417`*^9, 3.7330330643661723`*^9}, {3.733033344592759*^9, 
   3.7330333622227907`*^9}, {3.7330333992647676`*^9, 3.733033415614768*^9}, {
   3.7330334692788095`*^9, 3.7330334721178093`*^9}, {3.733033599267456*^9, 
   3.7330336567984357`*^9}, {3.733033890017474*^9, 3.733033915921472*^9}, {
   3.733033992279512*^9, 3.733034010231485*^9}, {3.73303404299749*^9, 
   3.733034147207505*^9}, {3.7330341978145123`*^9, 3.7330342574485435`*^9}, {
   3.733034294161525*^9, 3.7330343557884703`*^9}, {3.7330344120855064`*^9, 
   3.7330344243614793`*^9}, {3.733037421977493*^9, 3.7330374537555294`*^9}, {
   3.733037532124188*^9, 3.733037580153166*^9}, {3.7330376117391725`*^9, 
   3.7330376278651733`*^9}, {3.73303765961222*^9, 3.733037660115178*^9}, {
   3.7330377964201975`*^9, 3.733037891067733*^9}, {3.7330379900237503`*^9, 
   3.733038002947747*^9}, {3.7330391895888667`*^9, 3.733039207773902*^9}, {
   3.733039296517882*^9, 3.733039315913885*^9}, {3.733039392067896*^9, 
   3.733039401529896*^9}, {3.7330395810339527`*^9, 3.733039594266924*^9}, {
   3.7330402525387783`*^9, 3.7330403053207974`*^9}, {3.733040356150792*^9, 
   3.7330403780077977`*^9}},ExpressionUUID->"4778a134-4e06-4288-a0e2-\
3f4ba3b3234c"]
},
WindowSize->{943, 987},
WindowMargins->{{-6, Automatic}, {Automatic, 2}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 154, 3, 30, "Input", "ExpressionUUID" -> \
"6004d5fd-b489-4189-8d41-17e8c82e8fb4"],
Cell[715, 25, 50733, 1258, 6212, "Input", "ExpressionUUID" -> \
"4778a134-4e06-4288-a0e2-3f4ba3b3234c"]
}
]
*)

